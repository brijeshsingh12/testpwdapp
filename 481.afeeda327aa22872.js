"use strict";(self.webpackChunkInventoryAPPN=self.webpackChunkInventoryAPPN||[]).push([[481],{3481:(De,y,m)=>{m.r(y),m.d(y,{SaleModule:()=>je});var d=m(177),R=m(1472),i=m(9417),f=m(1626),h=m(5743),e=m(7705),v=m(5416),O=m(5312);let F=(()=>{class r{constructor(t){this.http=t,this.rootAPIPath=O.c.baseApiUrl}GetSOList(){return this.http.get(`${this.rootAPIPath}/Sale/SaleOrderList`)}GetCustomers(){return this.http.get(`${this.rootAPIPath}/Sale/GetCustomers`)}GetShippers(){return this.http.get(`${this.rootAPIPath}/Sale/GetShippers`)}GetUsers(){return this.http.get(`${this.rootAPIPath}/Sale/GetUsers`)}GetSuppliers(){return this.http.get(`${this.rootAPIPath}/Sale/GetSuppliers`)}GetSOByBillNo(t){return this.http.get(`${this.rootAPIPath}/Sale/GetSOByBillNo/${t}`)}GetSODetailsForShipped(t){return this.http.get(`${this.rootAPIPath}/Sale/GetSODetailsForShipped/${t}`)}GetSOReturnByBillNo(t){return this.http.get(`${this.rootAPIPath}/Sale/GetSOReturn/${t}`)}saveSaleOrder(t){const n={headers:new f.Lr({"Content-Type":"application/json"})};return this.http.post(`${this.rootAPIPath}/Sale/SaveOrder`,JSON.stringify(t),n)}UpdateSaleOrder(t){const n={headers:new f.Lr({"Content-Type":"application/json"})};return this.http.post(`${this.rootAPIPath}/Sale/UpdateOrder`,JSON.stringify(t),n)}DeleteSaleOrder(t){return this.http.delete(`${this.rootAPIPath}/Sale/DeleteSaleOrder/${t}`)}generateInvoicePdf(t){return this.http.post(`${this.rootAPIPath}/Sale/SOReport_PDF`,t,{responseType:"blob"})}UpdateProductShipped(t){const n={headers:new f.Lr({"Content-Type":"application/json"})};return this.http.post(`${this.rootAPIPath}/Sale/SaveSOShipped`,JSON.stringify(t),n)}UpdateProductReturn(t){const n={headers:new f.Lr({"Content-Type":"application/json"})};return this.http.post(`${this.rootAPIPath}/Sale/SaveSOReturn`,JSON.stringify(t),n)}static{this.\u0275fac=function(n){return new(n||r)(e.KVO(f.Qq))}}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var C=m(1322),g=m(6600),k=m(8834),j=m(9213),_=m(9631),u=m(6467),G=m(2798),b=m(5911),S=m(5084);function D(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Select PO Date"),e.k0s())}function $(r,a){if(1&r&&(e.j41(0,"mat-option",21),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.Y8G("value",t.partyCode),e.R7$(1),e.Lme("",t.firstName," ",t.lastName,"")}}function T(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Select Customer"),e.k0s())}function P(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Select Delivery Date"),e.k0s())}function B(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Enter Remark"),e.k0s())}function x(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Enter Delivery To"),e.k0s())}function q(r,a){if(1&r&&(e.j41(0,"mat-option",21),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.Y8G("value",t.itemCode),e.R7$(1),e.JRh(t.itemName)}}function Y(r,a){if(1&r){const t=e.RV6();e.j41(0,"button",29),e.bIt("click",function(){e.eBV(t);const o=e.XpG().index,l=e.XpG();return e.Njj(l.removeItem(o))}),e.j41(1,"mat-icon"),e.EFF(2,"delete"),e.k0s()()}}function U(r,a){if(1&r){const t=e.RV6();e.j41(0,"div",4)(1,"div",22)(2,"mat-form-field")(3,"mat-label"),e.EFF(4,"Item Code"),e.k0s(),e.j41(5,"mat-select",23),e.bIt("selectionChange",function(o){const s=e.eBV(t).index,p=e.XpG();return e.Njj(p.onItemChange(o.value,s))}),e.DNE(6,q,2,2,"mat-option",11),e.k0s(),e.j41(7,"mat-error",24),e.EFF(8," Item code is required "),e.k0s()(),e.j41(9,"mat-form-field")(10,"mat-label"),e.EFF(11,"Quantity"),e.k0s(),e.j41(12,"input",25),e.bIt("change",function(o){const s=e.eBV(t).index,p=e.XpG();return e.Njj(p.setAmount(o.target,s))}),e.k0s(),e.j41(13,"mat-error",24),e.EFF(14," Enter Quantity "),e.k0s()(),e.j41(15,"mat-form-field")(16,"mat-label"),e.EFF(17,"Unit Price"),e.k0s(),e.nrm(18,"input",26),e.k0s(),e.j41(19,"mat-form-field")(20,"mat-label"),e.EFF(21,"Amount"),e.k0s(),e.nrm(22,"input",27),e.j41(23,"mat-error",24),e.EFF(24," Enter Amount "),e.k0s()(),e.DNE(25,Y,3,0,"button",28),e.k0s(),e.nrm(26,"div",2),e.k0s()}if(2&r){const t=a.index,n=e.XpG();e.R7$(1),e.Y8G("formGroupName",t),e.R7$(5),e.Y8G("ngForOf",n.items),e.R7$(1),e.Y8G("hidden",n.f.saleOrderItems.controls[t].controls.itemcode.valid),e.R7$(6),e.Y8G("hidden",n.f.saleOrderItems.controls[t].controls.quantity.valid),e.R7$(10),e.Y8G("hidden",n.f.saleOrderItems.controls[t].controls.amount.valid),e.R7$(2),e.Y8G("ngIf",n.f.saleOrderItems.controls.length>1)}}let E=(()=>{class r{constructor(t,n,o,l){this.formBuilder=t,this.service=n,this.purchaseService=o,this.route=l,this._snackBar=(0,e.WQX)(v.UG),this.post="",this.invoiceData={billNo:"PO1003",date:"2025-04-30",customer:"1",remark:"Test Remark by Brijesh",deliveryDate:"2025-04-30",deliveryTo:"Sagarpur, New Delhi",saleOrderItems:[{itemcode:"Item100",quantity:10,unitPrice:100,amount:1e3},{itemcode:"Item101",quantity:20,unitPrice:200,amount:4e3},{itemcode:"Item102",quantity:50,unitPrice:10,amount:500}]}}ngOnInit(){this.createForm(),this.GetItems(),this.GetCustomers(),this.bindSOForID()}bindSOForID(){let t=this.route.snapshot.paramMap.get("billno");t&&this.service.GetSOByBillNo(t).subscribe(n=>{this.formGroup.patchValue(n);const o=n.saleOrderItems.map(s=>this.formBuilder.group({itemcode:[s.itemcode,i.k0.required],quantity:[s.quantity],unitPrice:[s.unitPrice],amount:[s.amount]})),l=this.formBuilder.array(o);this.formGroup.setControl("saleOrderItems",l)})}GetCustomers(){this.service.GetCustomers().subscribe(t=>{console.log(t),this.customers=t})}GetItems(){this.purchaseService.GetItems().subscribe(t=>{this.items=t})}createForm(){this.formGroup=this.formBuilder.group({billNo:[null,i.k0.required],date:[null,i.k0.required],customer:[null,i.k0.required],deliveryDate:[null,i.k0.required],remark:[null,i.k0.required],deliveryTo:[null,i.k0.required],saleOrderItems:this.formBuilder.array([this.initItem()])})}initItem(){return this.formBuilder.group({itemcode:["",i.k0.required],quantity:["",i.k0.required],unitPrice:["",i.k0.required],amount:["",i.k0.required]})}addItem(){this.formGroup.controls.saleOrderItems.push(this.initItem())}removeItem(t){this.formGroup.controls.saleOrderItems.removeAt(t)}get f(){return this.formGroup.controls}onSubmit(){console.log(this.formGroup.value),this.route.snapshot.paramMap.get("billno")?this.service.UpdateSaleOrder(this.formGroup.value).subscribe(o=>{this.openSnackBar("Data Updated","Close")}):this.service.saveSaleOrder(this.formGroup.value).subscribe(o=>{this.openSnackBar("Data Saved","Close")}),this.formGroup.reset(),this.formGroup.controls.saleOrderItems.clear()}onItemChange(t,n){let o=this.items.filter(s=>s.itemCode==t);this.formGroup.controls.saleOrderItems.at(n).get("unitPrice").setValue(o[0].price)}setAmount(t,n){const o=this.formGroup.controls.saleOrderItems;var l=o.at(n).get("unitPrice").value;const s=Number(t.value)*Number(l);o.at(n).get("amount").setValue(s)}downloadPdf(){this.service.generateInvoicePdf(this.invoiceData).subscribe(t=>{const n=window.URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="invoice.pdf",o.click(),window.URL.revokeObjectURL(n)})}openSnackBar(t,n){this._snackBar.open(t,n)}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(i.ok),e.rXU(F),e.rXU(C.z),e.rXU(h.nX))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sale-order"]],decls:61,vars:13,consts:[["novalidate","",1,"container"],[1,"fill-remaining-space"],[2,"padding-top","10px"],[3,"formGroup","ngSubmit"],[1,"example-container"],["matInput","","maxlength","10","formControlName","billNo"],["matIconSuffix","",3,"for"],["matInput","","formControlName","date",3,"matDatepicker"],["picker2",""],[4,"ngIf"],["formControlName","customer"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","deliveryDate",3,"matDatepicker"],["picker",""],["matInput","","formControlName","remark",2,"width","600px","height","100px"],["matInput","","formControlName","deliveryTo",2,"width","600px","height","100px"],["formArrayName","saleOrderItems",1,"example-container"],[1,"example-button-row"],["mat-stroked-button","","type","button",3,"click"],["class","example-container",4,"ngFor","ngForOf"],["mat-stroked-button","","type","button",3,"disabled","click"],[3,"value"],[3,"formGroupName"],["formControlName","itemcode",3,"selectionChange"],[3,"hidden"],["matInput","","type","text","formControlName","quantity",3,"change"],["matInput","","readonly","","type","text","formControlName","unitPrice"],["matInput","","type","text","formControlName","amount"],["mat-mini-fab","","aria-label","Delete",3,"click",4,"ngIf"],["mat-mini-fab","","aria-label","Delete",3,"click"]],template:function(n,o){if(1&n&&(e.j41(0,"div",0)(1,"mat-toolbar")(2,"span",1),e.EFF(3,"Sale Order"),e.k0s()(),e.nrm(4,"div",2),e.j41(5,"form",3),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(6,"div",4)(7,"mat-form-field")(8,"mat-label"),e.EFF(9,"Sale Order No"),e.k0s(),e.nrm(10,"input",5),e.k0s(),e.j41(11,"mat-form-field")(12,"mat-label"),e.EFF(13,"SO Date"),e.k0s(),e.nrm(14,"mat-datepicker-toggle",6)(15,"input",7)(16,"mat-datepicker",null,8),e.DNE(18,D,2,0,"mat-error",9),e.k0s(),e.j41(19,"mat-form-field")(20,"mat-label"),e.EFF(21,"Select Customer"),e.k0s(),e.j41(22,"mat-select",10),e.DNE(23,$,2,3,"mat-option",11),e.k0s(),e.DNE(24,T,2,0,"mat-error",9),e.k0s(),e.j41(25,"mat-form-field")(26,"mat-label"),e.EFF(27,"Delivery Date"),e.k0s(),e.nrm(28,"mat-datepicker-toggle",6)(29,"input",12)(30,"mat-datepicker",null,13),e.DNE(32,P,2,0,"mat-error",9),e.k0s()(),e.nrm(33,"div",2),e.j41(34,"div",4)(35,"mat-form-field")(36,"mat-label"),e.EFF(37,"Remark"),e.k0s(),e.nrm(38,"textarea",14),e.DNE(39,B,2,0,"mat-error",9),e.k0s(),e.j41(40,"mat-form-field")(41,"mat-label"),e.EFF(42,"Delivery To"),e.k0s(),e.nrm(43,"textarea",15),e.DNE(44,x,2,0,"mat-error",9),e.k0s()(),e.nrm(45,"div",2),e.j41(46,"div",16)(47,"mat-toolbar")(48,"span",1),e.EFF(49,"Enter Item Details:"),e.k0s()(),e.j41(50,"div",17)(51,"button",18),e.bIt("click",function(){return o.addItem()}),e.EFF(52,"Add New Item"),e.k0s()(),e.nrm(53,"div",2),e.DNE(54,U,27,6,"div",19),e.k0s(),e.nrm(55,"br"),e.j41(56,"div",17)(57,"button",20),e.bIt("click",function(){return o.onSubmit()}),e.EFF(58,"Submit"),e.k0s(),e.j41(59,"button",18),e.bIt("click",function(){return o.downloadPdf()}),e.EFF(60,"Download Invoice PDF"),e.k0s()()()()),2&n){const l=e.sdS(17),s=e.sdS(31);e.R7$(5),e.Y8G("formGroup",o.formGroup),e.R7$(9),e.Y8G("for",l),e.R7$(1),e.Y8G("matDatepicker",l),e.R7$(3),e.Y8G("ngIf",null==o.formGroup.controls.date.errors?null:o.formGroup.controls.date.errors.required),e.R7$(5),e.Y8G("ngForOf",o.customers),e.R7$(1),e.Y8G("ngIf",null==o.formGroup.controls.customer.errors?null:o.formGroup.controls.customer.errors.required),e.R7$(4),e.Y8G("for",s),e.R7$(1),e.Y8G("matDatepicker",s),e.R7$(3),e.Y8G("ngIf",null==o.formGroup.controls.deliveryDate.errors?null:o.formGroup.controls.deliveryDate.errors.required),e.R7$(7),e.Y8G("ngIf",null==o.formGroup.controls.remark.errors?null:o.formGroup.controls.remark.errors.required),e.R7$(5),e.Y8G("ngIf",null==o.formGroup.controls.deliveryTo.errors?null:o.formGroup.controls.deliveryTo.errors.required),e.R7$(10),e.Y8G("ngForOf",o.f.saleOrderItems.controls),e.R7$(3),e.Y8G("disabled",!o.formGroup.valid)}},dependencies:[d.Sq,d.bT,g.wT,k.$z,k.$0,j.An,_.fg,u.rl,u.nJ,u.TL,u.yw,G.VO,b.KQ,S.Vh,S.bZ,S.bU,i.qT,i.me,i.BC,i.cb,i.tU,i.j4,i.JD,i.$R,i.v8],styles:[".example-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%] + mat-form-field[_ngcontent-%COMP%]{margin-left:8px}"]})}}return r})();var I=m(6695),N=m(2042),c=m(9159),L=m(1802),A=m(5351),X=m(2232),w=m(4823);function V(r,a){1&r&&(e.j41(0,"mat-header-cell",22),e.EFF(1,"SO Number"),e.k0s())}function z(r,a){if(1&r&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.R7$(1),e.SpI(" ",t.billNo," ")}}function Q(r,a){1&r&&(e.j41(0,"mat-header-cell",22),e.EFF(1,"SO Date"),e.k0s())}function J(r,a){if(1&r&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.R7$(1),e.SpI(" ",t.soDate," ")}}function M(r,a){1&r&&(e.j41(0,"mat-header-cell",22),e.EFF(1,"Customer"),e.k0s())}function K(r,a){if(1&r&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.R7$(1),e.SpI(" ",t.partyName," ")}}function H(r,a){1&r&&(e.j41(0,"mat-header-cell",22),e.EFF(1,"Delivery Date"),e.k0s())}function Z(r,a){if(1&r&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.R7$(1),e.SpI(" ",t.deliveryDate," ")}}function W(r,a){1&r&&(e.j41(0,"mat-header-cell",22),e.EFF(1,"delivery Address"),e.k0s())}function ee(r,a){if(1&r&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.R7$(1),e.SpI(" ",t.deliveryTo," ")}}function te(r,a){1&r&&(e.j41(0,"mat-header-cell",22),e.EFF(1,"Remark"),e.k0s())}function re(r,a){if(1&r&&(e.j41(0,"mat-cell"),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.R7$(1),e.SpI(" ",t.remark," ")}}function oe(r,a){1&r&&(e.j41(0,"th",23),e.EFF(1," Edit "),e.k0s())}function ne(r,a){if(1&r){const t=e.RV6();e.j41(0,"td",24)(1,"button",25),e.bIt("click",function(){const l=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.Edit(l.billNo))}),e.EFF(2,"Edit"),e.k0s()()}}function ae(r,a){1&r&&(e.j41(0,"th",23),e.EFF(1," Remove "),e.k0s())}function ie(r,a){if(1&r){const t=e.RV6();e.j41(0,"td",24)(1,"button",26),e.bIt("click",function(){const l=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.RemoveSaleOrder(l.billNo))}),e.EFF(2,"Remove"),e.k0s()()}}function le(r,a){1&r&&e.nrm(0,"mat-header-row")}function se(r,a){1&r&&e.nrm(0,"mat-row")}const me=function(){return[5,10,25,100]};function ue(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Enter PO No"),e.k0s())}function ce(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Enter Receipt No"),e.k0s())}function de(r,a){if(1&r&&(e.j41(0,"mat-option",16),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.Y8G("value",t.id.toString()),e.R7$(1),e.JRh(t.name)}}function fe(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Select User"),e.k0s())}function he(r,a){if(1&r&&(e.j41(0,"mat-option",16),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.Y8G("value",t.shipperCode),e.R7$(1),e.JRh(t.shipperName)}}function Se(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Select Shipper"),e.k0s())}function ke(r,a){if(1&r){const t=e.RV6();e.j41(0,"div",4)(1,"div",17)(2,"mat-form-field")(3,"mat-label"),e.EFF(4,"Item Code"),e.k0s(),e.nrm(5,"input",18),e.k0s(),e.j41(6,"mat-form-field")(7,"mat-label"),e.EFF(8,"Item Name"),e.k0s(),e.nrm(9,"input",19),e.k0s(),e.j41(10,"mat-form-field")(11,"mat-label"),e.EFF(12,"Order Qty"),e.k0s(),e.nrm(13,"input",20),e.k0s(),e.j41(14,"mat-form-field")(15,"mat-label"),e.EFF(16,"Already Received Qty"),e.k0s(),e.nrm(17,"input",21),e.k0s(),e.j41(18,"mat-form-field")(19,"mat-label"),e.EFF(20,"Receive Qty."),e.k0s(),e.j41(21,"input",22),e.bIt("change",function(o){const s=e.eBV(t).index,p=e.XpG();return e.Njj(p.setBalance(o.target,s))}),e.k0s(),e.j41(22,"mat-error",23),e.EFF(23," Enter Shipped Quantity "),e.k0s()()(),e.nrm(24,"div",2),e.k0s()}if(2&r){const t=a.index,n=e.XpG();e.R7$(1),e.Y8G("formGroupName",t),e.R7$(21),e.Y8G("hidden",n.f.saleOrderItems.controls[t].controls.qtyShipped.valid)}}function _e(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Enter SO No"),e.k0s())}function be(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Enter Receipt No"),e.k0s())}function ve(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Enter Authorize No"),e.k0s())}function Ce(r,a){if(1&r&&(e.j41(0,"mat-option",20),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.Y8G("value",t.id.toString()),e.R7$(1),e.JRh(t.name)}}function ge(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Select Authorized By"),e.k0s())}function Ge(r,a){if(1&r&&(e.j41(0,"mat-option",20),e.EFF(1),e.k0s()),2&r){const t=a.$implicit;e.Y8G("value",t.shipperCode),e.R7$(1),e.JRh(t.shipperName)}}function Ne(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Select Shipper"),e.k0s())}function ye(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Enter Receipt No"),e.k0s())}function Ee(r,a){1&r&&(e.j41(0,"mat-error"),e.EFF(1,"Select Authorize Date"),e.k0s())}function Ie(r,a){if(1&r){const t=e.RV6();e.j41(0,"div",4)(1,"div",21)(2,"mat-form-field",22)(3,"mat-label"),e.EFF(4,"Item Code"),e.k0s(),e.nrm(5,"input",23),e.k0s(),e.j41(6,"mat-form-field",22)(7,"mat-label"),e.EFF(8,"Item Name"),e.k0s(),e.nrm(9,"input",24),e.k0s(),e.j41(10,"mat-form-field",22)(11,"mat-label"),e.EFF(12,"Order Qty."),e.k0s(),e.nrm(13,"input",25),e.k0s(),e.j41(14,"mat-form-field",22)(15,"mat-label"),e.EFF(16,"Shipped Qty"),e.k0s(),e.nrm(17,"input",26),e.k0s(),e.j41(18,"mat-form-field",22)(19,"mat-label"),e.EFF(20,"Already Returned Qty"),e.k0s(),e.nrm(21,"input",27),e.k0s(),e.j41(22,"mat-form-field",22)(23,"mat-label"),e.EFF(24,"Return Qty."),e.k0s(),e.j41(25,"input",28),e.bIt("change",function(o){const s=e.eBV(t).index,p=e.XpG();return e.Njj(p.setBalance(o.target,s))}),e.k0s(),e.j41(26,"mat-error",29),e.EFF(27," Enter Return Quantity "),e.k0s()(),e.j41(28,"mat-form-field",22)(29,"mat-label"),e.EFF(30,"Select Reason"),e.k0s(),e.j41(31,"mat-select",30)(32,"mat-option",31),e.EFF(33,"Fungas"),e.k0s(),e.j41(34,"mat-option",32),e.EFF(35,"Expiry"),e.k0s(),e.j41(36,"mat-option",33),e.EFF(37,"Break"),e.k0s()(),e.j41(38,"mat-error",29),e.EFF(39,"Select Reason"),e.k0s()()(),e.nrm(40,"div",2),e.k0s()}if(2&r){const t=a.index,n=e.XpG();e.R7$(1),e.Y8G("formGroupName",t),e.R7$(25),e.Y8G("hidden",n.f.saleOrderItems.controls[t].controls.qtyReturned.valid),e.R7$(12),e.Y8G("hidden",n.f.saleOrderItems.controls[t].controls.returnReason.valid)}}const Re=[{path:"sale-order",component:E},{path:"sale-order-list",component:(()=>{class r{constructor(t,n,o,l,s){this._saleService=t,this.excelService=n,this.dialog=o,this.snackBarService=l,this.router=s,this.SOList=[],this.displayedColumns=["billNo","soDate","partyName","deliveryDate","deliveryTo","remark","Edit","Remove"]}ngOnInit(){this.bindSaleOrders()}bindSaleOrders(){this._saleService.GetSOList().subscribe(t=>{null!=t&&(this.SOList=t,this.dataSource=new c.I6(t),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)})}applyFilter(t){this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}Edit(t){this.router.navigate(["/sale-order",t])}RemoveSaleOrder(t){this._saleService.DeleteSaleOrder(t).subscribe(n=>{n?(this.bindSaleOrders(),this.snackBarService.show("Sale Order Deleted","success")):this.snackBarService.show("Error Throwing!","error")})}exportAsXLSX(){this.excelService.exportAsExcelFile(this.SOList,"sample")}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(F),e.rXU(L.J),e.rXU(A.bZ),e.rXU(X.v),e.rXU(h.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sale-list"]],viewQuery:function(n,o){if(1&n&&(e.GBs(I.iy,5),e.GBs(N.B4,5)),2&n){let l;e.mGM(l=e.lsd())&&(o.paginator=l.first),e.mGM(l=e.lsd())&&(o.sort=l.first)}},decls:38,vars:5,consts:[[1,"fill-remaining-space"],[2,"padding-top","10px"],[2,"float","left"],["matInput","","placeholder","Search",3,"keyup"],[1,"example-container","mat-elevation-z8"],["mat-stroked-button","","color","primary",3,"click"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","billNo"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","soDate"],["matColumnDef","partyName"],["matColumnDef","deliveryDate"],["matColumnDef","deliveryTo"],["matColumnDef","remark"],["matColumnDef","Edit"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Remove"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"pageSizeOptions"],["mat-sort-header",""],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-raised-button","","color","warn","matTooltip","Edit",3,"click"],["mat-raised-button","","color","warn","matTooltip","Remove",3,"click"]],template:function(n,o){1&n&&(e.j41(0,"mat-toolbar")(1,"span",0),e.EFF(2,"Sale Order List"),e.k0s()(),e.nrm(3,"div",1),e.j41(4,"mat-form-field",2)(5,"input",3),e.bIt("keyup",function(s){return o.applyFilter(s.target.value)}),e.k0s()(),e.j41(6,"div",4)(7,"button",5),e.bIt("click",function(){return o.exportAsXLSX()}),e.EFF(8,"Download Excel"),e.k0s(),e.nrm(9,"div",1),e.j41(10,"table",6),e.qex(11,7),e.DNE(12,V,2,0,"mat-header-cell",8),e.DNE(13,z,2,1,"mat-cell",9),e.bVm(),e.qex(14,10),e.DNE(15,Q,2,0,"mat-header-cell",8),e.DNE(16,J,2,1,"mat-cell",9),e.bVm(),e.qex(17,11),e.DNE(18,M,2,0,"mat-header-cell",8),e.DNE(19,K,2,1,"mat-cell",9),e.bVm(),e.qex(20,12),e.DNE(21,H,2,0,"mat-header-cell",8),e.DNE(22,Z,2,1,"mat-cell",9),e.bVm(),e.qex(23,13),e.DNE(24,W,2,0,"mat-header-cell",8),e.DNE(25,ee,2,1,"mat-cell",9),e.bVm(),e.qex(26,14),e.DNE(27,te,2,0,"mat-header-cell",8),e.DNE(28,re,2,1,"mat-cell",9),e.bVm(),e.qex(29,15),e.DNE(30,oe,2,0,"th",16),e.DNE(31,ne,3,0,"td",17),e.bVm(),e.qex(32,18),e.DNE(33,ae,2,0,"th",16),e.DNE(34,ie,3,0,"td",17),e.bVm(),e.DNE(35,le,1,0,"mat-header-row",19),e.DNE(36,se,1,0,"mat-row",20),e.k0s(),e.nrm(37,"mat-paginator",21),e.k0s()),2&n&&(e.R7$(10),e.Y8G("dataSource",o.dataSource),e.R7$(25),e.Y8G("matHeaderRowDef",o.displayedColumns),e.R7$(1),e.Y8G("matRowDefColumns",o.displayedColumns),e.R7$(1),e.Y8G("pageSizeOptions",e.lJ4(4,me)))},dependencies:[k.$z,_.fg,u.rl,I.iy,N.B4,N.aE,c.Zl,c.tL,c.ji,c.cC,c.YV,c.iL,c.KS,c.$R,c.YZ,c.NB,b.KQ,w.oV]})}}return r})()},{path:"sale-order/:billno",component:E},{path:"product-shipping",component:(()=>{class r{constructor(t,n,o,l){this.formBuilder=t,this.service=n,this.purchaseService=o,this.route=l,this._snackBar=(0,e.WQX)(v.UG),this.createForm(),this.GetUsers(),this.GetShippers()}createForm(){this.formGroup=this.formBuilder.group({billNo:["",i.k0.required],agentCode:["",i.k0.required],shipperCode:["",i.k0.required],receiptNo:["",i.k0.required],remark:[""],saleOrderItems:this.formBuilder.array([this.initItem()])})}initItem(){return this.formBuilder.group({itemcode:[""],itemName:[""],quantity:[""],alreadyShipped:[""],qtyShipped:["",i.k0.required]})}GetShippers(){this.purchaseService.GetShippers().subscribe(t=>{this.shippers=t})}GetUsers(){this.purchaseService.GetUsers().subscribe(t=>{this.users=t})}bindSOForID(t){t&&this.service.GetSODetailsForShipped(t).subscribe(n=>{const o=n.map(s=>this.formBuilder.group({itemcode:[s.itemcode,i.k0.required],itemName:[s.itemName],quantity:[s.quantity],qtyShipped:[0],alreadyShipped:[s.alreadyShipped]})),l=this.formBuilder.array(o);this.formGroup.setControl("saleOrderItems",l)})}onSubmit(){this.service.UpdateProductShipped(this.formGroup.value).subscribe(t=>{this.formGroup.reset(),this.formGroup.controls.saleOrderItems.clear(),this.openSnackBar("Product Shipped","Close")})}onShow(){let t=this.formGroup.controls.billNo.value;""!=t?this.bindSOForID(t):this.openSnackBar("Please Enter Sale Order No","Close")}get f(){return this.formGroup.controls}setBalance(t,n){const o=this.formGroup.controls.saleOrderItems;var l=o.at(n).get("quantity").value,s=o.at(n).get("alreadyShipped").value;let p=Number(l)-Number(s);return Number(t.value)>0&&Number(t.value)>Number(p)&&(this.openSnackBar("Shipped Qty cannot greater then "+p,"Close"),o.at(n).get("qtyShipped").setValue(0)),!1}openSnackBar(t,n){this._snackBar.open(t,n)}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(i.ok),e.rXU(F),e.rXU(C.z),e.rXU(h.nX))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-product-shipping"]],decls:47,vars:8,consts:[["novalidate","",1,"container"],[1,"fill-remaining-space"],[2,"padding-top","10px"],[3,"formGroup","ngSubmit"],[1,"example-container"],["matInput","","maxlength","10","formControlName","billNo"],[4,"ngIf"],["mat-stroked-button","","type","button",2,"margin-left","20px",3,"click"],["matInput","","maxlength","10","formControlName","receiptNo"],["formControlName","agentCode"],[3,"value",4,"ngFor","ngForOf"],["formControlName","shipperCode"],["matInput","","formControlName","remark",2,"width","600px"],["formArrayName","saleOrderItems",1,"example-container"],["class","example-container",4,"ngFor","ngForOf"],["mat-stroked-button","","type","button",3,"click"],[3,"value"],[3,"formGroupName"],["matInput","","type","text","readonly","","formControlName","itemcode"],["matInput","","type","text","readonly","","formControlName","itemName"],["matInput","","type","text","readonly","","formControlName","quantity"],["matInput","","type","text","readonly","","formControlName","alreadyShipped"],["matInput","","type","text","formControlName","qtyShipped",3,"change"],[3,"hidden"]],template:function(n,o){1&n&&(e.j41(0,"div",0)(1,"mat-toolbar")(2,"span",1),e.EFF(3,"Product Shipping"),e.k0s()(),e.nrm(4,"div",2),e.j41(5,"form",3),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(6,"div",4)(7,"mat-form-field")(8,"mat-label"),e.EFF(9,"Sale OrderNo"),e.k0s(),e.nrm(10,"input",5),e.DNE(11,ue,2,0,"mat-error",6),e.k0s(),e.j41(12,"button",7),e.bIt("click",function(){return o.onShow()}),e.EFF(13,"Show"),e.k0s()(),e.nrm(14,"div",2),e.j41(15,"div",4)(16,"mat-form-field")(17,"mat-label"),e.EFF(18,"Receipt No"),e.k0s(),e.nrm(19,"input",8),e.DNE(20,ce,2,0,"mat-error",6),e.k0s(),e.j41(21,"mat-form-field")(22,"mat-label"),e.EFF(23,"Select User"),e.k0s(),e.j41(24,"mat-select",9),e.DNE(25,de,2,2,"mat-option",10),e.k0s(),e.DNE(26,fe,2,0,"mat-error",6),e.k0s(),e.j41(27,"mat-form-field")(28,"mat-label"),e.EFF(29,"Select Shipper"),e.k0s(),e.j41(30,"mat-select",11),e.DNE(31,he,2,2,"mat-option",10),e.k0s(),e.DNE(32,Se,2,0,"mat-error",6),e.k0s(),e.j41(33,"mat-form-field")(34,"mat-label"),e.EFF(35,"Remark"),e.k0s(),e.nrm(36,"textarea",12),e.k0s()(),e.nrm(37,"div",2),e.j41(38,"div",13)(39,"mat-toolbar")(40,"span",1),e.EFF(41,"Enter Item Shipped Detail"),e.k0s()(),e.nrm(42,"div",2),e.DNE(43,ke,25,2,"div",14),e.k0s(),e.nrm(44,"br"),e.j41(45,"button",15),e.bIt("click",function(){return o.onSubmit()}),e.EFF(46,"Submit"),e.k0s()()()),2&n&&(e.R7$(5),e.Y8G("formGroup",o.formGroup),e.R7$(6),e.Y8G("ngIf",null==o.formGroup.controls.billNo.errors?null:o.formGroup.controls.billNo.errors.required),e.R7$(9),e.Y8G("ngIf",null==o.formGroup.controls.receiptNo.errors?null:o.formGroup.controls.receiptNo.errors.required),e.R7$(5),e.Y8G("ngForOf",o.users),e.R7$(1),e.Y8G("ngIf",null==o.formGroup.controls.agentCode.errors?null:o.formGroup.controls.agentCode.errors.required),e.R7$(5),e.Y8G("ngForOf",o.shippers),e.R7$(1),e.Y8G("ngIf",null==o.formGroup.controls.shipperCode.errors?null:o.formGroup.controls.shipperCode.errors.required),e.R7$(11),e.Y8G("ngForOf",o.f.saleOrderItems.controls))},dependencies:[d.Sq,d.bT,g.wT,k.$z,_.fg,u.rl,u.nJ,u.TL,G.VO,b.KQ,i.qT,i.me,i.BC,i.cb,i.tU,i.j4,i.JD,i.$R,i.v8],styles:[".example-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%] + mat-form-field[_ngcontent-%COMP%]{margin-left:8px}"]})}}return r})()},{path:"so-return",component:(()=>{class r{constructor(t,n,o,l){this.formBuilder=t,this.service=n,this.purchaseService=o,this.route=l,this._snackBar=(0,e.WQX)(v.UG),this.createForm(),this.GetUsers(),this.GetShippers()}createForm(){this.formGroup=this.formBuilder.group({billNo:["",i.k0.required],authorizedBy:["",i.k0.required],shipperCode:["",i.k0.required],receiptNo:["",i.k0.required],authorizedNo:["",i.k0.required],authorizedDate:["",i.k0.required],remark:[""],saleOrderItems:this.formBuilder.array([this.initItem()])})}openSnackBar(t,n){this._snackBar.open(t,n)}initItem(){return this.formBuilder.group({itemcode:[""],itemName:[""],quantity:[""],alreadyShipped:[""],alreadyReturned:[""],returnReason:[""],qtyReturned:["",i.k0.required]})}GetShippers(){this.purchaseService.GetShippers().subscribe(t=>{this.shippers=t})}GetUsers(){this.purchaseService.GetUsers().subscribe(t=>{this.users=t})}bindSOForID(t){t&&this.service.GetSOReturnByBillNo(t).subscribe(n=>{if(0==n.length)return void this.openSnackBar("Invalid SO No","Close");const o=n.map(s=>this.formBuilder.group({itemcode:[s.itemcode,i.k0.required],itemName:[s.itemName],quantity:[s.quantity],alreadyShipped:[s.alreadyShipped],alreadyReturned:[s.alreadyReturned],returnReason:[s.returnReason],qtyReturned:[0]})),l=this.formBuilder.array(o);this.formGroup.setControl("saleOrderItems",l)})}onSubmit(){console.log(JSON.stringify(this.formGroup.value)),this.service.UpdateProductReturn(this.formGroup.value).subscribe(t=>{this.formGroup.reset(),this.formGroup.controls.saleOrderItems.clear(),this.openSnackBar("Product Returned","Close")})}onShow(){let t=this.formGroup.controls.billNo.value;""!=t?this.bindSOForID(t):this.openSnackBar("Please Enter Sale Order No","Close")}get f(){return this.formGroup.controls}setBalance(t,n){const o=this.formGroup.controls.saleOrderItems;var l=o.at(n).get("alreadyReturned").value,s=o.at(n).get("alreadyShipped").value;let p=Number(s)-Number(l);return Number(t.value)>0&&Number(t.value)>Number(p)&&(this.openSnackBar("Return Qty cannot greater then "+p,"Close"),o.at(n).get("qtyReturned").setValue(0)),!1}static{this.\u0275fac=function(n){return new(n||r)(e.rXU(i.ok),e.rXU(F),e.rXU(C.z),e.rXU(h.nX))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-sale-return"]],decls:66,vars:13,consts:[["novalidate","",1,"container"],[1,"fill-remaining-space"],[2,"padding-top","10px"],[3,"formGroup","ngSubmit"],[1,"example-container"],["matInput","","maxlength","10","formControlName","billNo","placeholder","Sale Order No"],[4,"ngIf"],["mat-stroked-button","","type","button",2,"margin-left","20px",3,"click"],["matInput","","maxlength","10","formControlName","receiptNo"],["matInput","","maxlength","10","formControlName","authorizedNo"],["formControlName","authorizedBy"],[3,"value",4,"ngFor","ngForOf"],["formControlName","shipperCode"],["matIconSuffix","",3,"for"],["matInput","","formControlName","authorizedDate",3,"matDatepicker"],["picker",""],["matInput","","formControlName","remark"],["formArrayName","saleOrderItems",1,"example-container"],["class","example-container",4,"ngFor","ngForOf"],["mat-stroked-button","","type","button",3,"click"],[3,"value"],[3,"formGroupName"],[2,"width","140px"],["matInput","","type","text","readonly","","formControlName","itemcode"],["matInput","","type","text","readonly","","formControlName","itemName"],["matInput","","type","text","readonly","","formControlName","quantity",2,"width","80px"],["matInput","","type","text","readonly","","formControlName","alreadyShipped",2,"width","80px"],["matInput","","type","text","readonly","","formControlName","alreadyReturned",2,"width","80px"],["matInput","","type","text","formControlName","qtyReturned",2,"width","80px",3,"change"],[3,"hidden"],["formControlName","returnReason"],["value","Fungas"],["value","Expiry"],["value","Break"]],template:function(n,o){if(1&n&&(e.j41(0,"div",0)(1,"mat-toolbar")(2,"span",1),e.EFF(3,"Sale Order Return"),e.k0s()(),e.nrm(4,"div",2),e.j41(5,"form",3),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(6,"div",4)(7,"mat-form-field")(8,"mat-label"),e.EFF(9,"Sale OrderNo"),e.k0s(),e.nrm(10,"input",5),e.DNE(11,_e,2,0,"mat-error",6),e.k0s(),e.j41(12,"button",7),e.bIt("click",function(){return o.onShow()}),e.EFF(13,"Show"),e.k0s()(),e.nrm(14,"div",2),e.j41(15,"div",4)(16,"mat-form-field")(17,"mat-label"),e.EFF(18,"Receipt No"),e.k0s(),e.nrm(19,"input",8),e.DNE(20,be,2,0,"mat-error",6),e.k0s(),e.j41(21,"mat-form-field")(22,"mat-label"),e.EFF(23,"Authorize No"),e.k0s(),e.nrm(24,"input",9),e.DNE(25,ve,2,0,"mat-error",6),e.k0s(),e.j41(26,"mat-form-field")(27,"mat-label"),e.EFF(28,"Select Authorized By"),e.k0s(),e.j41(29,"mat-select",10),e.DNE(30,Ce,2,2,"mat-option",11),e.k0s(),e.DNE(31,ge,2,0,"mat-error",6),e.k0s(),e.j41(32,"mat-form-field")(33,"mat-label"),e.EFF(34,"Select Shipper"),e.k0s(),e.j41(35,"mat-select",12),e.DNE(36,Ge,2,2,"mat-option",11),e.k0s(),e.DNE(37,Ne,2,0,"mat-error",6),e.k0s(),e.j41(38,"mat-form-field")(39,"mat-label"),e.EFF(40,"Enter Receipt No"),e.k0s(),e.nrm(41,"input",8),e.DNE(42,ye,2,0,"mat-error",6),e.k0s(),e.nrm(43,"div",2),e.j41(44,"mat-form-field")(45,"mat-label"),e.EFF(46,"Authorized Date"),e.k0s(),e.nrm(47,"mat-datepicker-toggle",13)(48,"input",14)(49,"mat-datepicker",null,15),e.DNE(51,Ee,2,0,"mat-error",6),e.k0s(),e.j41(52,"mat-form-field")(53,"mat-label"),e.EFF(54,"Remark"),e.k0s(),e.nrm(55,"textarea",16),e.k0s()(),e.nrm(56,"div",2),e.j41(57,"div",17)(58,"mat-toolbar")(59,"span",1),e.EFF(60,"Enter Item Return Detail"),e.k0s()(),e.nrm(61,"div",2),e.DNE(62,Ie,41,3,"div",18),e.k0s(),e.nrm(63,"br"),e.j41(64,"button",19),e.bIt("click",function(){return o.onSubmit()}),e.EFF(65,"Submit"),e.k0s()()()),2&n){const l=e.sdS(50);e.R7$(5),e.Y8G("formGroup",o.formGroup),e.R7$(6),e.Y8G("ngIf",null==o.formGroup.controls.billNo.errors?null:o.formGroup.controls.billNo.errors.required),e.R7$(9),e.Y8G("ngIf",null==o.formGroup.controls.receiptNo.errors?null:o.formGroup.controls.receiptNo.errors.required),e.R7$(5),e.Y8G("ngIf",null==o.formGroup.controls.authorizedNo.errors?null:o.formGroup.controls.authorizedNo.errors.required),e.R7$(5),e.Y8G("ngForOf",o.users),e.R7$(1),e.Y8G("ngIf",null==o.formGroup.controls.authorizedBy.errors?null:o.formGroup.controls.authorizedBy.errors.required),e.R7$(5),e.Y8G("ngForOf",o.shippers),e.R7$(1),e.Y8G("ngIf",null==o.formGroup.controls.shipperCode.errors?null:o.formGroup.controls.shipperCode.errors.required),e.R7$(5),e.Y8G("ngIf",null==o.formGroup.controls.receiptNo.errors?null:o.formGroup.controls.receiptNo.errors.required),e.R7$(5),e.Y8G("for",l),e.R7$(1),e.Y8G("matDatepicker",l),e.R7$(3),e.Y8G("ngIf",null==o.formGroup.controls.authorizedDate.errors?null:o.formGroup.controls.authorizedDate.errors.required),e.R7$(11),e.Y8G("ngForOf",o.f.saleOrderItems.controls)}},dependencies:[d.Sq,d.bT,g.wT,k.$z,_.fg,u.rl,u.nJ,u.TL,u.yw,G.VO,b.KQ,S.Vh,S.bZ,S.bU,i.qT,i.me,i.BC,i.cb,i.tU,i.j4,i.JD,i.$R,i.v8],styles:[".example-container[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%] + mat-form-field[_ngcontent-%COMP%]{margin-left:8px}"]})}}return r})()}];let Oe=(()=>{class r{static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[h.iI.forChild(Re),h.iI]})}}return r})(),je=(()=>{class r{constructor(){console.log("sale module")}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275mod=e.$C({type:r})}static{this.\u0275inj=e.G2t({imports:[d.MD,Oe,R.G,i.X1,i.YN,f.q1]})}}return r})()}}]);